# 🚀 RACK CATEGORY SYSTEM - DEPLOYMENT GUIDE\n\n## ⚡ QUICK START (5 Minutes)\n\n### Step 1: Backup Database (Optional but Recommended)\n```bash\n# On your server\nmysql-dump -u root -p warehouse_wms > backup_$(date +%Y%m%d_%H%M%S).sql\n```\n\n### Step 2: Pull Latest Code\n```bash\ncd ~/staging-app  # or your app directory\ngit pull origin stable/prisma-mysql-production\n```\n\n### Step 3: Rebuild & Restart\n```bash\n# Backend\ncd backend\nnpm install  # if needed\ndocker-compose build backend\ndocker-compose up -d backend\n\n# Frontend  \ncd ../frontend\nnpm install  # if needed\nnpm run build\ndocker-compose build frontend\ndocker-compose up -d frontend\n```\n\n### Step 4: Clear Browser Cache\n```\nUser machine: Ctrl+Shift+Delete → Clear all → Refresh page\n```\n\n### Step 5: Test\n```\n1. Login to app\n2. Go to Racks\n3. Create new rack\n4. See category dropdown ✅\n```\n\n**Done! 🎉**\n\n---\n\n## 📋 DETAILED DEPLOYMENT STEPS\n\n### For Staging Environment\n\n#### Step 1: SSH to Staging Server\n```bash\nssh staging@148.230.107.155\nPassword: Qgocargo@321\n```\n\n#### Step 2: Navigate to App\n```bash\ncd ~/staging-app\n```\n\n#### Step 3: Pull Latest Code\n```bash\ngit pull origin stable/prisma-mysql-production\n```\n\n#### Step 4: Check Files Changed\n```bash\ngit status\n\n# Should show:\n# - backend/src/routes/racks.ts (modified)\n# - frontend/src/components/CreateRackModal.tsx (modified)\n# - frontend/src/components/EditRackModal.tsx (modified)\n# - frontend/src/pages/Racks/Racks.tsx (modified)\n# - frontend/src/services/api.ts (modified)\n```\n\n#### Step 5: Rebuild Containers\n```bash\n# Rebuild backend\ndocker-compose build staging-backend\n\n# Rebuild frontend\ndocker-compose build staging-frontend\n```\n\n#### Step 6: Restart Services\n```bash\n# Stop old containers\ndocker-compose down\n\n# Start with new code\ndocker-compose up -d\n\n# Check status\ndocker-compose ps\n\n# All should show \"Up\"\n```\n\n#### Step 7: Verify Backend\n```bash\n# Check API is responding\ncurl http://localhost:5001/api/health\n\n# Should return: {\"status\":\"ok\",\"message\":\"...\"}\n```\n\n#### Step 8: Check Logs\n```bash\n# If something wrong\ndocker-compose logs staging-backend --tail 50\ndocker-compose logs staging-frontend --tail 50\n```\n\n#### Step 9: Test in Browser\n```\nURL: http://staging.qgocargo.cloud:8080\n\n1. Login\n2. Go to Racks\n3. Click \"Create Rack\"\n4. Check category dropdown loads\n5. Create test rack with category\n6. Verify category shows on card\n```\n\n---\n\n### For Production Deployment\n\n**Same steps but:**\n```bash\n# Use production server\nssh root@qgocargo.cloud\nPassword: Qgocargo@123\n\ncd /home/staging/staging-app  # or your prod path\n\n# Then follow same steps as staging above\n```\n\n---\n\n## 🔍 VERIFICATION CHECKLIST\n\n### Backend\n- [ ] Container running: `docker-compose ps`\n- [ ] API responding: `curl http://localhost:5001/api/health`\n- [ ] New endpoint works: `curl http://localhost:5001/api/racks/categories/list -H \"Authorization: Bearer $TOKEN\"`\n- [ ] No errors in logs: `docker-compose logs backend`\n\n### Frontend\n- [ ] Container running: `docker-compose ps`\n- [ ] Page loads: http://staging.qgocargo.cloud:8080\n- [ ] No console errors: F12 → Console tab\n- [ ] API calls working: F12 → Network tab → check requests\n\n### Functionality\n- [ ] Login works\n- [ ] Can navigate to Racks\n- [ ] Create Rack modal opens\n- [ ] Category dropdown appears\n- [ ] Can select category\n- [ ] Category preview shows\n- [ ] Can create rack\n- [ ] Rack card shows category (LARGE)\n- [ ] Can edit rack\n- [ ] Can change category\n- [ ] Changes save successfully\n\n---\n\n## 🚨 TROUBLESHOOTING\n\n### Issue: Backend Container Won't Start\n\n**Error in logs:**\n```\nError: Cannot find module\n```\n\n**Solution:**\n```bash\n# Rebuild from scratch\ndocker-compose down\nrm -rf backend/node_modules\ndocker-compose build --no-cache backend\ndocker-compose up -d\n```\n\n### Issue: Frontend Shows Blank\n\n**Solution:**\n```bash\n# Clear cache\ndocker-compose down\ndocker-compose up -d frontend\n\n# Clear browser cache\nBrowser: Ctrl+Shift+Delete\nClear all → Refresh\n```\n\n### Issue: Category Dropdown Empty\n\n**Solution:**\n```bash\n# Check database has categories\nmysql -u root -p warehouse_wms -e \"SELECT * FROM categories LIMIT 5;\"\n\n# If empty, create test categories\nmysql -u root -p warehouse_wms -e \"\nINSERT INTO categories (id, name, description, isActive, companyId, createdAt, updatedAt) VALUES\n('cat1', 'DIOR', 'Luxury Fashion', 1, 'company_id', NOW(), NOW()),\n('cat2', 'JAZEERA', 'General Storage', 1, 'company_id', NOW(), NOW());\n\"\n\n# Refresh page\n```\n\n### Issue: API Returns 404\n\n**Problem:**\n```\nGET /api/racks/categories/list → 404 Not Found\n```\n\n**Solution:**\n```bash\n# Check route is added\ngrep -n \"categories/list\" backend/src/routes/racks.ts\n\n# Rebuild backend\ndocker-compose build backend\ndocker-compose restart backend\n\n# Test again\ncurl http://localhost:5001/api/racks/categories/list\n```\n\n### Issue: Database Connection Error\n\n**Error in logs:**\n```\nError: Connect ECONNREFUSED 127.0.0.1:3306\n```\n\n**Solution:**\n```bash\n# Check database container\ndocker-compose ps | grep database\n\n# If not running\ndocker-compose up -d database\n\n# Check database health\nmysql -u root -p -e \"SELECT 1;\"\n```\n\n---\n\n## 📊 ROLLBACK PROCEDURE (If Issues)\n\n### Step 1: Stop Containers\n```bash\ndocker-compose down\n```\n\n### Step 2: Revert Code\n```bash\ngit revert HEAD\n```\n\n### Step 3: Rebuild\n```bash\ndocker-compose build\ndocker-compose up -d\n```\n\n### Step 4: Verify\n```bash\ndocker-compose ps\ncurl http://localhost:5001/api/health\n```\n\n---\n\n## 📝 DEPLOYMENT CHECKLIST\n\n### Pre-Deployment\n- [ ] Code reviewed\n- [ ] Tested on local machine\n- [ ] Tested on staging server\n- [ ] Database backup taken\n- [ ] Maintenance window scheduled (if needed)\n- [ ] Team notified\n\n### Deployment\n- [ ] Code pulled to production\n- [ ] Backend rebuilt\n- [ ] Frontend rebuilt\n- [ ] Containers restarted\n- [ ] Logs checked for errors\n- [ ] API health check passed\n- [ ] Browser cache cleared\n\n### Post-Deployment\n- [ ] Manual testing completed\n- [ ] User acceptance testing\n- [ ] Monitor logs for errors\n- [ ] Check error tracking (Sentry, etc.)\n- [ ] Notify team of completion\n- [ ] Document any issues\n\n---\n\n## 🔄 CI/CD Integration (Optional)\n\nIf using GitHub Actions:\n\n```yaml\nname: Deploy Rack Category System\n\non:\n  push:\n    branches: [main]\n    paths:\n      - 'backend/src/routes/racks.ts'\n      - 'frontend/src/components/*RackModal.tsx'\n      - 'frontend/src/pages/Racks/**'\n      - 'frontend/src/services/api.ts'\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n      - name: Build and deploy\n        run: |\n          ssh staging@server 'cd ~/app && git pull && docker-compose build && docker-compose up -d'\n```\n\n---\n\n## 📞 SUPPORT\n\nIf deployment fails:\n\n1. **Check logs first:**\n   ```bash\n   docker-compose logs -f\n   ```\n\n2. **Check Git status:**\n   ```bash\n   git status\n   git log --oneline -5\n   ```\n\n3. **Test API:**\n   ```bash\n   curl http://localhost:5001/api/racks/categories/list -H \"Authorization: Bearer TOKEN\"\n   ```\n\n4. **Check database:**\n   ```bash\n   mysql -u root -p warehouse_wms\n   > SELECT * FROM racks LIMIT 5;\n   > SELECT * FROM categories LIMIT 5;\n   ```\n\n---\n\n## ✅ FINAL VERIFICATION\n\n### On Staging\n```\n✅ Backend running\n✅ Frontend running\n✅ Category dropdown working\n✅ Create rack with category works\n✅ Category displays on card (LARGE)\n✅ Edit category works\n✅ No console errors\n✅ No backend errors\n```\n\n### Ready for Production? ✅ YES!\n\n---\n\n**Deployment Time**: ~15-20 minutes  \n**Downtime**: None (containers restart gracefully)  \n**Risk Level**: Low (only UI/API changes, no DB migration)  \n**Rollback Time**: ~5 minutes if needed  \n\n**Status**: Ready to Deploy! 🚀\n